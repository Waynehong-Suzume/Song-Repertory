<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>후즈아트 공연 투표</title>
  <link rel="stylesheet" href="style.css" />
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
    import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBxg5nkxqOUgPcIOpKWix5j2HMf5PqCEZ4",
      authDomain: "result-c03f9.firebaseapp.com",
      projectId: "result-c03f9",
      storageBucket: "result-c03f9.firebasestorage.app",
      messagingSenderId: "619925483736",
      appId: "1:619925483736:web:459b09d355994a4ff567ad",
      measurementId: "G-BCRNTEQDDS",
      databaseURL: "https://result-c03f9-default-rtdb.firebaseio.com"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    window.submitVote = () => {
  const checkboxes = document.querySelectorAll("input[name='song']:checked");

  // 이미 투표했지만 체크박스 아무것도 선택 안 한 경우
  if (localStorage.getItem("voted") === "yes") {
    if (checkboxes.length === 0) {
      alert("⚠️ 최소 한 곡 이상 선택해주세요!");
    } else {
      alert("🚫 이미 투표하셨습니다. 한 번만 투표할 수 있어요!");
    }
    return;
  }

  // 처음 투표인데 체크 안 했을 경우
  if (checkboxes.length === 0) {
    alert("⚠️ 최소 한 곡 이상 선택해주세요!");
    return;
  }

  // 정상 투표 진행
  const selections = Array.from(checkboxes).map(cb => cb.value);
  selections.forEach(song => {
    push(ref(db, "votes/" + song.replaceAll(".", "").replaceAll("/", "")), true);
  });
  alert("✅ 투표가 완료되었습니다!");
  localStorage.setItem("voted", "yes");
  document.querySelectorAll("input[name='song']").forEach(cb => cb.checked = false);
};
  </script>
</head>
<body>
  <div class="container">
    <h1>🎶 청바지팀 공연 투표</h1>
    <p class="subtitle">마음에 드는 곡을 모두 선택하고 투표해주세요! 제목을 클릭하면 유튜브로 이동해요 🎧</p>
    <form onsubmit="event.preventDefault(); submitVote();">
      <ul class="song-list">
        <li><label><input type="checkbox" name="song" value="A Whole New World – 알라딘" /><a href="https://www.youtube.com/watch?v=XUSjObJku0Q" target="_blank">A Whole New World – 알라딘</a></label></li>
<li><label><input type="checkbox" name="song" value="Bundle of Joy – 인사이드 아웃" /><a href="https://www.youtube.com/watch?v=32lI1Z1MBx0" target="_blank">Bundle of Joy – 인사이드 아웃</a></label></li>
<li><label><input type="checkbox" name="song" value="How Far I’ll Go – 모아나" /><a href="https://www.youtube.com/watch?v=cPAbx5kgCJo" target="_blank">How Far I’ll Go – 모아나</a></label></li>
<li><label><input type="checkbox" name="song" value="I See the Light – 라푼젤" /><a href="https://www.youtube.com/watch?v=ILRs2r6lcHY" target="_blank">I See the Light – 라푼젤</a></label></li>
<li><label><input type="checkbox" name="song" value="Le Festin – 라따뚜이" /><a href="https://www.youtube.com/watch?v=G3lSONLLx70" target="_blank">Le Festin – 라따뚜이</a></label></li>
<li><label><input type="checkbox" name="song" value="Sparkle – 너의 이름은" /><a href="https://www.youtube.com/watch?v=a2GujJZfXpg" target="_blank">Sparkle – 너의 이름은</a></label></li>
<li><label><input type="checkbox" name="song" value="Steal The Show – 엘리멘탈" /><a href="https://www.youtube.com/watch?v=DwuJeGYlYyw" target="_blank">Steal The Show – 엘리멘탈</a></label></li>
<li><label><input type="checkbox" name="song" value="This is me – 위대한 쇼맨" /><a href="https://www.youtube.com/watch?v=h2TLNdaQkL4" target="_blank">This is me – 위대한 쇼맨</a></label></li>
<li><label><input type="checkbox" name="song" value="Try Everything – 주토피아" /><a href="https://www.youtube.com/watch?v=c6rP-YP4c5I" target="_blank">Try Everything – 주토피아</a></label></li>
<li><label><input type="checkbox" name="song" value="Your New Home – The Amazing Digital Cirucs" /><a href="https://www.youtube.com/watch?v=9peSeroXH-s" target="_blank">Your New Home - The Amazing Digital Cirucs</a></label></li>
<li><label><input type="checkbox" name="song" value="すずめ (Suzume) – 스즈메의 문단속" /><a href="https://www.youtube.com/watch?v=Xs0Lxif1u9E" target="_blank">すずめ (Suzume) – 스즈메의 문단속</a></label></li>
<li><label><input type="checkbox" name="song" value="너를 태우고 – 천공의 성 라퓨타" /><a href="https://www.youtube.com/watch?v=D2CRlGawlOI" target="_blank">너를 태우고 – 천공의 성 라퓨타</a></label></li>
<li><label><input type="checkbox" name="song" value="바다가 보이는 마을 – 마녀 배달부 키키" /><a href="https://www.youtube.com/watch?v=zajkxWnnAaI" target="_blank">바다가 보이는 마을 – 마녀 배달부 키키</a></label></li>
<li><label><input type="checkbox" name="song" value="벼랑 위의 포뇨 – 벼랑 위의 포뇨" /><a href="https://www.youtube.com/watch?v=GZXPGv0kOAQ" target="_blank">벼랑 위의 포뇨 – 벼랑 위의 포뇨</a></label></li>
<li><label><input type="checkbox" name="song" value="산책 – 이웃집 토토로" /><a href="https://www.youtube.com/watch?v=YCpDQIi_VDY" target="_blank">산책 – 이웃집 토토로</a></label></li>
<li><label><input type="checkbox" name="song" value="세계의 약속 – 하울의 움직이는 성" /><a href="https://www.youtube.com/watch?v=K1DCI7Fhums" target="_blank">세계의 약속 – 하울의 움직이는 성</a></label></li>
<li><label><input type="checkbox" name="song" value="아시타카의 전설 – 원령공주" /><a href="https://www.youtube.com/watch?v=x8rl5hq6SBA" target="_blank">아시타카의 전설 – 원령공주</a></label></li>
<li><label><input type="checkbox" name="song" value="어느 여름날 – 센과 치히로의 행방불명" /><a href="https://www.youtube.com/watch?v=qbuMbV1Rdo8" target="_blank">어느 여름날 – 센과 치히로의 행방불명</a></label></li>
<li><label><input type="checkbox" name="song" value="오월의 마을 – 이웃집 토토로" /><a href="https://www.youtube.com/watch?v=oAoe-V1jjgw" target="_blank">오월의 마을 – 이웃집 토토로</a></label></li>
<li><label><input type="checkbox" name="song" value="인생의 회전목마 – 하울의 움직이는 성" /><a href="https://www.youtube.com/watch?v=NXt-YY3Xt8Q" target="_blank">인생의 회전목마 – 하울의 움직이는 성</a></label></li>
      </ul>
      <button type="submit">🎤 투표 제출</button>
    </form>
    <hr style="margin: 30px 0;" />
    <p><a href="results.html">📊 실시간 결과 보기</a></p>
  </div>
</body>
</html>
